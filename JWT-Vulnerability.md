# JWT Tokens 

JSON Web Tokens (JWTs) are a commonly used way to authenticate users and authorize access to web applications. However, if implemented improperly, they can be vulnerable to attacks. For example, an attacker could try to modify the contents of a JWT to gain access to a user's account or system. This can happen if the JWT is not properly signed or verified using strong cryptographic algorithms.

Another vulnerability is the expiration time of a JWT. If this is not enforced properly, an attacker could use an expired token to gain access to the system. Additionally, if the JWT is stored on the client side, such as in a cookie or local storage, it could be vulnerable to theft by malicious code or cross-site scripting (XSS) attacks.

Finally, because JWTs do not provide encryption, the contents of a JWT can be viewed by anyone who intercepts it. This means that sensitive information such as user credentials or session data could be exposed.

To avoid these vulnerabilities, it is important to implement JWTs using best practices, such as properly signing and verifying the token, enforcing expiration times, storing the token securely on the server side, and minimizing the amount of sensitive information included in the token's payload.

## Resource being used while exploring JWT Vulberability are given below:
 
 - WebGoat (https://github.com/iamrachit/Cyber-Security-INeuron/blob/main/Setup-WebGoat-WebWolf.md)
 - Burpsuit (https://portswigger.net/burp/releases/professional-community-2023-1-2?requestededition=community&requestedplatform=)
 - jwt.io (https://jwt.io/)
 
## Exploring JWT Token on WebGoat

Their are multiple modules of JWT Token in WebGoat and all the modules are explained below: 

### JWT Token Module 1

Its all about some basic introduction about JSON Web Tokens (JWT) Vulnerability. 

```
http://localhost:8080/WebGoat/start.mvc#lesson/JWT.lesson/0
```

![image](https://user-images.githubusercontent.com/60937657/219865211-7c218886-82cf-420f-a691-8829ec51d0c3.png)

### JWT Token Module 2

Structure of a JWT Token is explained in this module.  

```
localhost:8080/WebGoat/start.mvc#lesson/JWT.lesson/1
```

![image](https://user-images.githubusercontent.com/60937657/220130210-223c09af-8059-4908-b75e-2718f61837d1.png)

### JWT Token Module 3

In this module we need to decode a jwt token and for that we will make use of jwt.io (https://jwt.io/).

```
localhost:8080/WebGoat/start.mvc#lesson/JWT.lesson/3
```

Steps for decoding a JWT token are given below: 


- Step 1: Copy the given JWT token. 


![image](https://user-images.githubusercontent.com/60937657/220133796-c9f10042-efeb-4776-a975-90ecccdaecbd.png)

```
eyJhbGciOiJIUzI1NiJ9.ew0KICAiYXV0aG9yaXRpZXMiIDogWyAiUk9MRV9BRE1JTiIsICJST0xFX1VTRVIiIF0sDQogICJjbGllbnRfaWQiIDogIm15LWNsaWVudC13aXRoLXNlY3JldCIsDQogICJleHAiIDogMTYwNzA5OTYwOCwNCiAgImp0aSIgOiAiOWJjOTJhNDQtMGIxYS00YzVlLWJlNzAtZGE1MjA3NWI5YTg0IiwNCiAgInNjb3BlIiA6IFsgInJlYWQiLCAid3JpdGUiIF0sDQogICJ1c2VyX25hbWUiIDogInVzZXIiDQp9.9lYaULTuoIDJ86-zKDSntJQyHPpJ2mZAbnWRfel99iI
```


- Step 2: Open the jwt.io and paste the copied JWT token in the encoded section. 


![image](https://user-images.githubusercontent.com/60937657/220135512-707398ff-4868-4d86-b465-0be7b6946e80.png)

As seen from the above given image we will get the decoded JWT token which can show us the user name. 

![image](https://user-images.githubusercontent.com/60937657/220135976-7a24553e-71ba-4bc1-b09d-832f4da28db2.png)


- Step 3: Enter the user name; which is "user" in our case. 


![image](https://user-images.githubusercontent.com/60937657/220136680-809ad5be-65ed-42c5-84ef-b919740bb0ef.png)

### JWT Token Module 4 

Module 4 is about the authentication and getting a JWT token. 

```
localhost:8080/WebGoat/start.mvc#lesson/JWT.lesson/3
```

![image](https://user-images.githubusercontent.com/60937657/220143853-58fa1dd0-0d9a-4716-bd25-e878aa6b8409.png)

### JWT Token Module 8

Module 8 is about cracking the JWT.

![image](https://user-images.githubusercontent.com/60937657/224869038-3b3770c9-3f67-4348-8a9b-ad86331c3cf9.png)

Modify the jwt code value using jwt.io

![image](https://user-images.githubusercontent.com/60937657/224870271-f52483f1-be39-4509-af73-bddcda642d92.png)

To crack the jwt first we need to intercept the request after clicking on submit option on webgoat 

![image](https://user-images.githubusercontent.com/60937657/224869830-72a509e5-e5fc-40da-a491-82942b897500.png)

After we get the above request we need to enter encoded JWT value in 'token=' section and to do that i need to go to repeater by left click and select repeater option.

![image](https://user-images.githubusercontent.com/60937657/224870094-5eb61315-dd1d-4ff6-b25e-d6a9384f6213.png)

